<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META content="no-cache" http-equiv="pragma">
    <META content="-1" http-equiv="expires">
    <META content="text/html;charset=UTF-8" http-equiv="content-type">
    <LINK href="problem-statement.css" rel="stylesheet" type="text/css">
    <TITLE>须弥的山头</TITLE>
    <SCRIPT type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
        });
        </SCRIPT>
        <SCRIPT async="" src="https://polygon.codeforces.com/lib/MathJax/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
    </SCRIPT>
</HEAD><BODY>
    <DIV class="problem-statement"><DIV class="header"><DIV class="title">须弥的山头</DIV><DIV class="time-limit"><DIV class="property-title">time limit per test</DIV>4.5 seconds</DIV><DIV class="memory-limit"><DIV class="property-title">memory limit per test</DIV>256 megabytes</DIV><DIV class="input-file"><DIV class="property-title">input</DIV>standard input</DIV><DIV class="output-file"><DIV class="property-title">output</DIV>standard output</DIV></DIV><DIV class="legend"><P>须弥沙漠有许多山，这些山大都无法攀爬，让旅行者感觉很不方便。</P><P>众所周知，蒙德城的温迪曾经削掉了蒙德的山头丢进海里以平整地块，并形成了金苹果群岛。</P><P>然而温迪不能削掉这些山头，但是他可以帮助你完成<SPAN class="tex-font-style-bf">至多一次</SPAN>上山。</P><P>这些山头都可以被近似认为是多边形，如下图所示，最短路的顶点一定在障碍物多边形的顶点上。</P><P></P><CENTER> <IMG class="tex-graphics" src="d0425882f8e91f035218fb25db1c73dc2768c93c.png">   <SPAN class="tex-font-size-small">一条从$$$S$$$到$$$T$$$的最短路</SPAN> </CENTER><P></P><P>温迪觉得这道题对你来说太难了，所以他帮你处理了几何关系，确切地说，他将告诉你起点，终点，各个多边形的顶点之间是所有无需上山可达的点对，恰好一次上山可达的点对，以及这些点对之间的距离。</P><P>看不懂没关系，形式化地，给出一个有红蓝两种边的无向带权图，求至多经过一条蓝边的从起点到终点的最短路。或者断言无论如何都无法到达终点。</P><P></P><CENTER> <IMG class="tex-graphics" src="09e5fd3d5ccfe3af14a6df7e8cea76326c84075d.png">   <SPAN class="tex-font-size-small">温迪可爱！</SPAN> </CENTER></DIV><P></P><P></P><DIV class="input-specification"><DIV class="section-title">Input</DIV><P></P><P>第一行三个正整数$$$n$$$、$$$m$$$、$$$k$$$（$$$3 \le n \le 2 \cdot 10^5$$$，$$$2 \le m + k \le \min\{\dfrac{(n + 1)(n + 2)}{2}, 2 \cdot 10^5\}$$$），表示多边形顶点的个数（<SPAN class="tex-font-style-bf">不含起点和终点，编号$$$3, 4, ..., n + 2$$$</SPAN>），无需上山可达的点对的数量（红边数量），恰好一次上山可达的点对的数量（蓝边数量）。</P><P>接下来$$$m$$$行，每行三个整数$$$i$$$、$$$j$$$、$$$w$$$（$$$1 \le i &lt; j \le n + 2$$$，$$$0 \le w \le 10^4$$$），表示点$$$i$$$和点$$$j$$$之间无需上山可达（红边），距离为$$$w$$$。</P><P>接下来$$$k$$$行，每行三个整数$$$i$$$、$$$j$$$、$$$w$$$（$$$1 \le i &lt; j \le n + 2$$$，$$$0 \le w \le 10^4$$$），表示点$$$i$$$和点$$$j$$$之间恰好一次上山可达（蓝边），距离为$$$w$$$。</P></DIV><P></P><P></P><DIV class="output-specification"><DIV class="section-title">Output</DIV><P></P><P>一个整数，表示起点$$$1$$$到终点$$$2$$$的最短距离，或者$$$-1$$$表示无法到达。</P></DIV><P></P><P></P><DIV class="sample-tests"><DIV class="section-title">Examples</DIV><P></P><P></P><DIV class="sample-test"><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">3 5 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">4 5 3</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 5 3</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 4 9</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 3 10</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 5 4</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
8
</PRE></DIV><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">3 0 4</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">4 5 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 5 1</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
-1
</PRE></DIV><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">4 4 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 6 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3 0</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">4 5 0</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4 0</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 6 3</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
4
</PRE></DIV></DIV></DIV></DIV><P></P><P>  </P>

</BODY></HTML>