<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META content="no-cache" http-equiv="pragma">
    <META content="-1" http-equiv="expires">
    <META content="text/html;charset=UTF-8" http-equiv="content-type">
    <LINK href="problem-statement.css" rel="stylesheet" type="text/css">
    <TITLE>Mountains in Sumeru</TITLE>
    <SCRIPT type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
        });
        </SCRIPT>
        <SCRIPT async="" src="https://polygon.codeforces.com/lib/MathJax/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
    </SCRIPT>
</HEAD><BODY>
    <DIV class="problem-statement"><DIV class="header"><DIV class="title">Mountains in Sumeru</DIV><DIV class="time-limit"><DIV class="property-title">time limit per test</DIV>4.5 seconds</DIV><DIV class="memory-limit"><DIV class="property-title">memory limit per test</DIV>256 megabytes</DIV><DIV class="input-file"><DIV class="property-title">input</DIV>standard input</DIV><DIV class="output-file"><DIV class="property-title">output</DIV>standard output</DIV></DIV><DIV class="legend"><P>The Sumeru Desert is home to many mountains, most of which are unclimbable, causing inconvenience for travelers.</P><P>As is widely known, Venti from Mondstadt once leveled Mondstadt's mountainous terrain by submerging the mountain ranges into the sea, giving rise to the Golden Apple Archipelago.</P><P>However, Venti can't level these mountains, but he can assist you in ascending them <SPAN class="tex-font-style-bf">at most once</SPAN>.</P><P>These mountains can be roughly considered as polygons, as depicted in the diagram below, where the vertices of the shortest path must reside on the vertices of the obstacle polygons.</P><P></P><CENTER> <IMG class="tex-graphics" src="d0425882f8e91f035218fb25db1c73dc2768c93c.png">   <SPAN class="tex-font-size-small">The shortest path from $$$S$$$ to $$$T$$$</SPAN> </CENTER><P></P><P>Considering this problem might be too challenging for you, Venti has taken care of the geometric relationships. Specifically, he will provide you with information on the starting point, ending point, pairs of points between vertices of each polygon that are reachable without climbing, exactly once reachable pairs with a climb, and the distances between these pairs.</P><P>If you find it hard to grasp, don't worry. In formal terms, you are given an undirected weighted graph with edges in two colors (red and blue). Your task is to find the shortest path from the starting point to the ending point, passing through at most one blue edge, or confirm that reaching the ending point is impossible.</P><P></P><CENTER> <IMG class="tex-graphics" src="09e5fd3d5ccfe3af14a6df7e8cea76326c84075d.png">   <SPAN class="tex-font-size-small">Venti is adorable!</SPAN> </CENTER></DIV><P></P><P></P><DIV class="input-specification"><DIV class="section-title">Input</DIV><P></P><P>The first line consists of three positive integers, $$$n$$$, $$$m$$$, and $$$k$$$ ($$$3 \le n \le 2 \cdot 10^5$$$ï¼Œ$$$2 \le m + k \le \min\{\dfrac{(n + 1)(n + 2)}{2}, 2 \cdot 10^5\}$$$), representing the number of vertices in the polygon (<SPAN class="tex-font-style-bf">excluding the starting point and ending point, numbered $$$3, 4, ..., n + 2$$$</SPAN>), the quantity of point pairs reachable without climbing (number of red edges), and the quantity of point pairs reachable exactly once with a climb (number of blue edges).</P><P>Following that, there are $$$m$$$ lines, each containing three integers, $$$i$$$, $$$j$$$, and $$$w$$$ ($$$1 \le i &lt; j \le n + 2$$$, $$$0 \le w \le 10^4$$$), indicating that points $$$i$$$ and $$$j$$$ are reachable without climbing (red edge), with a distance of $$$w$$$.</P><P>Afterwards, there are $$$k$$$ lines, each containing three integers, $$$i$$$, $$$j$$$, and $$$w$$$ ($$$1 \le i &lt; j \le n + 2$$$, $$$0 \le w \le 10^4$$$), indicating that points $$$i$$$ and $$$j$$$ are reachable exactly once with a climb (blue edge), with a distance of $$$w$$$.</P></DIV><P></P><P></P><DIV class="output-specification"><DIV class="section-title">Output</DIV><P></P><P>An integer representing the shortest distance from the starting point $$$1$$$ to the ending point $$$2$$$, or $$$-1$$$ indicating that it is not possible to reach the destination.</P></DIV><P></P><P></P><DIV class="sample-tests"><DIV class="section-title">Examples</DIV><P></P><P></P><DIV class="sample-test"><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">3 5 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">4 5 3</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 5 3</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 4 9</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 3 10</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 5 4</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
8
</PRE></DIV><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">3 0 4</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">4 5 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 5 1</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
-1
</PRE></DIV><DIV class="input"><DIV class="title">Input</DIV><PRE class="content">
<DIV class="test-example-line test-example-line-even test-example-line-0">4 4 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 6 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 3 0</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">4 5 0</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">3 4 0</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">2 6 3</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
4
</PRE></DIV></DIV></DIV></DIV><P></P><P>  </P>

</BODY></HTML>