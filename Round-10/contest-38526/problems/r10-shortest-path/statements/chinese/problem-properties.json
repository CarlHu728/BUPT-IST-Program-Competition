{"extraResources":{"example.01.mu":"TVXzATMgNSAyDQoyIDMgMQ0KMyA0IDINCjQgNSAzDQoxIDUgMw0KMSA0IDkNCjEgMyAxMA0KMyA1IDQNCg==","example.02.mu":"TVXzATMgMCA0DQoyIDMgMQ0KMyA0IDENCjQgNSAxDQoxIDUgMQ0K","example.03.mu":"TVXzATQgNCAxDQoxIDYgMQ0KMiAzIDANCjQgNSAwDQozIDQgMA0KMiA2IDMNCg=="},"scoring":null,"notes":"","legend":"须弥沙漠有许多山，这些山大都无法攀爬，让旅行者感觉很不方便。\r\n\r\n众所周知，蒙德城的温迪曾经削掉了蒙德的山头丢进海里以平整地块，并形成了金苹果群岛。\r\n\r\n然而温迪不能削掉这些山头，但是他可以帮助你完成\\textbf{至多一次}上山。\r\n\r\n这些山头都可以被近似认为是多边形，如下图所示，最短路的顶点一定在障碍物多边形的顶点上。\r\n\r\n\\begin{center}\r\n  \\includegraphics[scale=0.8]{example.png} \\\\\r\n  \\small{一条从$S$到$T$的最短路}\r\n\\end{center}\r\n\r\n温迪觉得这道题对你来说太难了，所以他帮你处理了几何关系，确切地说，他将告诉你起点，终点，各个多边形的顶点之间是所有无需上山可达的点对，恰好一次上山可达的点对，以及这些点对之间的距离。\r\n\r\n看不懂没关系，形式化地，给出一个有红蓝两种边的无向带权图，求至多经过一条蓝边的从起点到终点的最短路。或者断言无论如何都无法到达终点。\r\n\r\n\\begin{center}\r\n  \\includegraphics[scale=0.15]{venti.jpg} \\\\\r\n  \\small{温迪可爱！}\r\n\\end{center}\r\n","authorLogin":"CaveNightingale","language":"chinese","timeLimit":4500,"output":"一个整数，表示起点$1$到终点$2$的最短距离，或者$-1$表示无法到达。","inputFile":"stdin","outputFile":"stdout","input":"第一行三个正整数$n$、$m$、$k$（$3 \\le n \\le 2 \\cdot 10^5$，$2 \\le m + k \\le \\min\\{\\dfrac{(n + 1)(n + 2)}{2}, 2 \\cdot 10^5\\}$），表示多边形顶点的个数（\\textbf {不含起点和终点，编号$3, 4, ..., n + 2$}），无需上山可达的点对的数量（红边数量），恰好一次上山可达的点对的数量（蓝边数量）。\r\n\r\n接下来$m$行，每行三个整数$i$、$j$、$w$（$1 \\le i < j \\le n + 2$，$0 \\le w \\le 10^4$），表示点$i$和点$j$之间无需上山可达（红边），距离为$w$。\r\n\r\n接下来$k$行，每行三个整数$i$、$j$、$w$（$1 \\le i < j \\le n + 2$，$0 \\le w \\le 10^4$），表示点$i$和点$j$之间恰好一次上山可达（蓝边），距离为$w$。\r\n","authorName":"Huabin Yuan","sampleTests":[{"output":"8\r\n","input":"3 5 2\r\n2 3 1\r\n3 4 2\r\n4 5 3\r\n1 5 3\r\n1 4 9\r\n1 3 10\r\n3 5 4\r\n","inputFile":"example.01","outputFile":"example.01.a"},{"output":"-1\r\n","input":"3 0 4\r\n2 3 1\r\n3 4 1\r\n4 5 1\r\n1 5 1\r\n","inputFile":"example.02","outputFile":"example.02.a"},{"output":"4\r\n","input":"4 4 1\r\n1 6 1\r\n2 3 0\r\n4 5 0\r\n3 4 0\r\n2 6 3\r\n","inputFile":"example.03","outputFile":"example.03.a"}],"name":"须弥的山头","interaction":null,"memoryLimit":268435456,"tutorial":""}