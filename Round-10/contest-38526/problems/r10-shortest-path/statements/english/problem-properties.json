{"extraResources":{"example.01.mu":"TVXzATMgNSAyDQoyIDMgMQ0KMyA0IDINCjQgNSAzDQoxIDUgMw0KMSA0IDkNCjEgMyAxMA0KMyA1IDQNCg==","example.02.mu":"TVXzATMgMCA0DQoyIDMgMQ0KMyA0IDENCjQgNSAxDQoxIDUgMQ0K","example.03.mu":"TVXzATQgNCAxDQoxIDYgMQ0KMiAzIDANCjQgNSAwDQozIDQgMA0KMiA2IDMNCg=="},"scoring":null,"notes":"","legend":"The Sumeru Desert is home to many mountains, most of which are unclimbable, causing inconvenience for travelers.\r\n\r\nAs is widely known, Venti from Mondstadt once leveled Mondstadt's mountainous terrain by submerging the mountain ranges into the sea, giving rise to the Golden Apple Archipelago.\r\n\r\nHowever, Venti can't level these mountains, but he can assist you in ascending them \\textbf{at most once}.\r\n\r\nThese mountains can be roughly considered as polygons, as depicted in the diagram below, where the vertices of the shortest path must reside on the vertices of the obstacle polygons.\r\n\r\n\\begin{center}\r\n    \\includegraphics[scale=0.8]{example.png} \\\\\r\n    \\small{The shortest path from $S$ to $T$}\r\n\\end{center}\r\n\r\nConsidering this problem might be too challenging for you, Venti has taken care of the geometric relationships. Specifically, he will provide you with information on the starting point, ending point, pairs of points between vertices of each polygon that are reachable without climbing, exactly once reachable pairs with a climb, and the distances between these pairs.\r\n\r\nIf you find it hard to grasp, don't worry. In formal terms, you are given an undirected weighted graph with edges in two colors (red and blue). Your task is to find the shortest path from the starting point to the ending point, passing through at most one blue edge, or confirm that reaching the ending point is impossible.\r\n\r\n\\begin{center}\r\n    \\includegraphics[scale=0.15]{venti.jpg} \\\\\r\n    \\small{Venti is adorable!}\r\n\\end{center}","authorLogin":"CaveNightingale","language":"english","timeLimit":4500,"output":"An integer representing the shortest distance from the starting point $1$ to the ending point $2$, or $-1$ indicating that it is not possible to reach the destination.","inputFile":"stdin","outputFile":"stdout","input":"The first line consists of three positive integers, $n$, $m$, and $k$ ($3 \\le n \\le 2 \\cdot 10^5$ï¼Œ$2 \\le m + k \\le \\min\\{\\dfrac{(n + 1)(n + 2)}{2}, 2 \\cdot 10^5\\}$), representing the number of vertices in the polygon (\\textbf{excluding the starting point and ending point, numbered $3, 4, ..., n + 2$}), the quantity of point pairs reachable without climbing (number of red edges), and the quantity of point pairs reachable exactly once with a climb (number of blue edges).\r\n\r\nFollowing that, there are $m$ lines, each containing three integers, $i$, $j$, and $w$ ($1 \\le i < j \\le n + 2$, $0 \\le w \\le 10^4$), indicating that points $i$ and $j$ are reachable without climbing (red edge), with a distance of $w$.\r\n\r\nAfterwards, there are $k$ lines, each containing three integers, $i$, $j$, and $w$ ($1 \\le i < j \\le n + 2$, $0 \\le w \\le 10^4$), indicating that points $i$ and $j$ are reachable exactly once with a climb (blue edge), with a distance of $w$.","authorName":"Huabin Yuan","sampleTests":[{"output":"8\r\n","input":"3 5 2\r\n2 3 1\r\n3 4 2\r\n4 5 3\r\n1 5 3\r\n1 4 9\r\n1 3 10\r\n3 5 4\r\n","inputFile":"example.01","outputFile":"example.01.a"},{"output":"-1\r\n","input":"3 0 4\r\n2 3 1\r\n3 4 1\r\n4 5 1\r\n1 5 1\r\n","inputFile":"example.02","outputFile":"example.02.a"},{"output":"4\r\n","input":"4 4 1\r\n1 6 1\r\n2 3 0\r\n4 5 0\r\n3 4 0\r\n2 6 3\r\n","inputFile":"example.03","outputFile":"example.03.a"}],"name":"Mountains in Sumeru","interaction":null,"memoryLimit":268435456,"tutorial":""}